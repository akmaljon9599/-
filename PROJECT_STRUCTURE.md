# Структура проекта "Система управления курьерскими заявками"

## Общая информация
Полноценная система управления курьерскими заявками банка с разграничением ролей пользователей, отслеживанием геолокации, управлением документами и интеграцией с внешними сервисами.

## Структура файлов и директорий

```
courier-system/
├── backend/                          # Backend приложение (PHP)
│   ├── api/
│   │   └── index.php                 # Главный API роутер
│   ├── config/
│   │   ├── app.php                   # Основная конфигурация приложения
│   │   ├── database.php              # Настройки подключения к БД
│   │   └── Database.php              # Класс для работы с базой данных
│   ├── controllers/                  # Контроллеры API
│   │   ├── AuthController.php        # Контроллер аутентификации
│   │   ├── CourierController.php     # Контроллер курьеров
│   │   ├── DashboardController.php   # Контроллер дашборда
│   │   ├── DeliveryRequestController.php # Контроллер заявок
│   │   ├── UploadController.php      # Контроллер загрузки файлов
│   │   └── UserController.php        # Контроллер пользователей
│   ├── middleware/
│   │   └── AuthMiddleware.php        # Middleware авторизации и прав
│   └── models/                       # Модели данных
│       ├── Courier.php               # Модель курьера
│       ├── DeliveryRequest.php       # Модель заявки на доставку
│       └── User.php                  # Модель пользователя
├── database/
│   └── schema.sql                    # Схема базы данных MySQL
├── frontend/                         # Frontend приложение
│   ├── css/                          # Стили (пустая, стили в HTML)
│   ├── js/
│   │   ├── app.js                    # Основное приложение JavaScript
│   │   └── map.js                    # Модуль работы с Яндекс.Картами
│   └── pages/                        # HTML страницы (пустая)
├── uploads/                          # Директории для загруженных файлов
│   ├── documents/                    # Документы (паспорта, договоры)
│   ├── photos/                       # Фотографии доставки
│   └── signatures/                   # Электронные подписи
├── logs/                             # Логи системы
├── .env.example                      # Пример файла конфигурации
├── .htaccess                         # Настройки Apache
├── DEPLOYMENT.md                     # Инструкция по развертыванию
├── README.md                         # Основная документация
├── PROJECT_STRUCTURE.md             # Этот файл
└── фронт тест.html                   # Главная страница приложения
```

## Компоненты системы

### 1. База данных (MySQL)
- **Таблицы**: 12 основных таблиц
- **Роли**: 4 роли пользователей (admin, senior_courier, courier, operator)
- **Функции**: Управление заявками, пользователями, курьерами, документами
- **Особенности**: Полная нормализация, индексы для производительности

### 2. Backend API (PHP)
- **Архитектура**: MVC с RESTful API
- **Аутентификация**: JWT токены
- **Авторизация**: Разграничение прав по ролям
- **Безопасность**: Хеширование паролей, валидация данных, CORS
- **Логирование**: Действия пользователей и системные события

### 3. Frontend (HTML5/CSS3/JavaScript)
- **Фреймворк**: Bootstrap 5
- **Иконки**: FontAwesome 6
- **Интерфейс**: Адаптивный дизайн для всех устройств
- **SPA**: Одностраничное приложение с динамической загрузкой контента

### 4. Интеграции
- **Яндекс.Карты**: Отображение курьеров и точек доставки
- **Геолокация**: Автоматическое отслеживание курьеров
- **АБС банка**: Подготовлена структура для интеграции
- **Файлы**: Загрузка документов, фото, электронных подписей

## Функциональность по ролям

### Администратор
- ✅ Полный доступ ко всем функциям
- ✅ Управление пользователями и правами
- ✅ Настройка системы
- ✅ Просмотр всех заявок и отчетности
- ✅ Мониторинг местоположения курьеров

### Старший курьер
- ✅ Просмотр заявок филиала/подразделения
- ✅ Назначение курьеров на заявки
- ✅ Печать договоров оферты
- ✅ Управление курьерами подразделения
- ✅ Изменение статусов заявок

### Курьер
- ✅ Просмотр назначенных заявок
- ✅ Изменение статуса на "Доставлено"/"Отказано"
- ✅ Загрузка фотографий доставки (минимум 2)
- ✅ Автоматическая отправка геолокации (каждые 60 сек)
- ✅ Ввод комментариев при отказе (минимум 100 символов)

### Оператор
- ✅ Добавление новых заявок
- ✅ Редактирование заявок
- ✅ Просмотр заявок с фильтрацией
- ✅ Выгрузка данных в Excel

## API Endpoints

### Аутентификация
- `POST /backend/api/auth/login` - Вход в систему
- `POST /backend/api/auth/logout` - Выход
- `GET /backend/api/auth/me` - Текущий пользователь
- `PUT /backend/api/auth/profile` - Обновить профиль
- `POST /backend/api/auth/change-password` - Изменить пароль

### Заявки
- `GET /backend/api/requests` - Список заявок
- `GET /backend/api/requests/{id}` - Заявка по ID
- `POST /backend/api/requests` - Создать заявку
- `PUT /backend/api/requests/{id}` - Обновить заявку
- `POST /backend/api/requests/{id}/update-status` - Изменить статус
- `POST /backend/api/requests/{id}/assign-courier` - Назначить курьера
- `GET /backend/api/requests/export` - Экспорт в Excel
- `GET /backend/api/requests/statistics` - Статистика

### Курьеры
- `GET /backend/api/couriers` - Список курьеров
- `GET /backend/api/couriers/online` - Онлайн курьеры
- `GET /backend/api/couriers/map` - Курьеры для карты
- `POST /backend/api/couriers/{id}/location` - Обновить местоположение
- `POST /backend/api/couriers/{id}/status` - Изменить статус

### Пользователи
- `GET /backend/api/users` - Список пользователей
- `GET /backend/api/users/{id}` - Пользователь по ID
- `POST /backend/api/users` - Создать пользователя
- `PUT /backend/api/users/{id}` - Обновить пользователя
- `DELETE /backend/api/users/{id}` - Деактивировать пользователя

### Загрузка файлов
- `POST /backend/api/upload/photo` - Загрузить фото
- `POST /backend/api/upload/document` - Загрузить документ
- `POST /backend/api/upload/signature` - Сохранить подпись

### Дашборд
- `GET /backend/api/dashboard` - Статистика для дашборда

## Технические особенности

### Безопасность
- JWT аутентификация с проверкой срока действия
- Хеширование паролей с помощью PHP password_hash()
- Защита от брутфорса (ограничение попыток входа)
- Валидация и санитизация всех входных данных
- CORS настройки для безопасных запросов
- Защита системных файлов через .htaccess

### Производительность
- Индексы в базе данных для быстрых запросов
- Пагинация для больших списков
- Кэширование статических ресурсов
- Сжатие HTTP ответов
- Оптимизированные SQL запросы

### Мониторинг
- Логирование всех действий пользователей
- Логи ошибок и исключений
- История изменений заявок
- Отслеживание местоположения курьеров
- Автоматическая очистка старых логов

### Масштабируемость
- Модульная архитектура
- Разделение на слои (Model-Controller-API)
- Подготовка к кластеризации
- Возможность горизонтального масштабирования

## Требования к системе

### Минимальные требования
- **PHP**: 7.4+
- **MySQL**: 5.7+
- **Apache/Nginx**: Любая современная версия
- **RAM**: 2GB
- **Диск**: 10GB

### Рекомендуемые требования
- **PHP**: 8.0+
- **MySQL**: 8.0+
- **RAM**: 4GB+
- **Диск**: 50GB+ (для логов и файлов)
- **SSD**: Для лучшей производительности

## Статус разработки

### ✅ Завершено
- [x] Проектирование архитектуры системы
- [x] Создание схемы базы данных
- [x] Разработка backend API
- [x] Система аутентификации и авторизации
- [x] Frontend интерфейс с адаптивным дизайном
- [x] Отслеживание геолокации курьеров
- [x] Система управления документами
- [x] Интеграция с Яндекс.Картами
- [x] Система фильтрации и поиска
- [x] Экспорт данных в Excel
- [x] Электронная подпись документов
- [x] Логирование и мониторинг
- [x] Документация и инструкции по развертыванию

### 🔄 В планах для следующих версий
- [ ] Мобильное приложение для курьеров
- [ ] Push-уведомления
- [ ] Интеграция с SMS-сервисами
- [ ] Расширенная аналитика и отчеты
- [ ] Интеграция с 1C
- [ ] API для внешних систем
- [ ] Чат-бот для клиентов

## Контакты разработчика
По вопросам доработки и поддержки системы обращайтесь к техническому руководителю проекта.

---
**Версия**: 1.0.0  
**Дата**: Сентябрь 2025  
**Статус**: Production Ready